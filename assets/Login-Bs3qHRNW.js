import{d as x,r as f,a as y,c as V,b as s,w as r,u as I,e as t,o as b,f as h,g as q,E as _,_ as C}from"./index-BuMj_rhx.js";const E=[{username:"xsq",password:"5201314",token:"admin-token",userInfo:{id:1,username:"xsq",avatar:"https://avatars.githubusercontent.com/u/1?v=4",roles:["admin"]}}],L=(c,d)=>new Promise((a,n)=>{setTimeout(()=>{const o=E.find(l=>l.username===c&&l.password===d);o?a({token:o.token,userInfo:o.userInfo}):n(new Error("用户名或密码错误"))},300)}),N={class:"login-container"},B=x({__name:"Login",setup(c){const d=I(),a=f(!1),n=f(),o=y({username:"",password:""}),l={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},g=async()=>{n.value&&await n.value.validate(async p=>{if(p){a.value=!0;try{const{token:e,userInfo:u}=await L(o.username,o.password);localStorage.setItem("token",e),localStorage.setItem("userInfo",JSON.stringify(u)),_.success("登录成功"),d.push("/")}catch(e){_.error(e.message)}finally{a.value=!1}}})};return(p,e)=>{const u=t("el-input"),i=t("el-form-item"),w=t("el-button"),v=t("el-form"),k=t("el-card");return b(),V("div",N,[s(k,{class:"login-card"},{header:r(()=>e[2]||(e[2]=[h("h3",null,"系统登录",-1)])),default:r(()=>[s(v,{model:o,rules:l,ref_key:"loginFormRef",ref:n},{default:r(()=>[s(i,{prop:"username"},{default:r(()=>[s(u,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=m=>o.username=m),placeholder:"用户名","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password"},{default:r(()=>[s(u,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=m=>o.password=m),type:"password",placeholder:"密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(i,null,{default:r(()=>[s(w,{type:"primary",onClick:g,loading:a.value,block:""},{default:r(()=>e[3]||(e[3]=[q(" 登录 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])}}}),R=C(B,[["__scopeId","data-v-390c902a"]]);export{R as default};
